
# Бот для игры «Бункер» в Telegram

Добро пожаловать в репозиторий Telegram-бота для популярной игры «Бункер»! Этот бот позволяет проводить игру полностью в среде Telegram, с удобным управлением комнатами, автоматической генерацией характеристик персонажей, таймерами обсуждений и многим другим.

## Возможности

- **Создание и управление комнатами**: Хост может создать новую комнату, пригласить игроков по коду, настроить количество участников и параметры игры.
- **Генерация персонажей**: Бот автоматически генерирует профессию, биологию, здоровье, хобби, багаж, факт, фобию, талант и социальный статус для каждого игрока.
- **Процесс игры**:
  - **Обсуждение**: Игроки могут обсуждать свои характеристики в общем чате.
  - **Голосование**: После обсуждения проводится голосование за исключение игрока.
  - **Исключение**: Проигравший раунд игрок покидает комнату, а его характеристики раскрываются остальным.
  - **Завершение игры**: Игра продолжается, пока не останется необходимое число выживших.
- **Система достижений и рейтинга**:
  - Отслеживание побед и поражений для каждого игрока.
  - Начисление достижений за различные достижения (например, первая победа, участие в определённом количестве игр).
- **Чат-функционал**:
  - Отправка сообщений всем игрокам комнаты.
  - Приватные сообщения отдельным участникам.
- **Таймеры**:
  - Хост может запустить таймер обсуждения.
  - По истечении времени бот уведомит всех о завершении обсуждения и автоматически начнёт голосование.

## Требования

- Python 3.9+ (рекомендуется использовать актуальную версию Python)
- Библиотеки:
  - [pyTelegramBotAPI](https://github.com/eternnoir/pyTelegramBotAPI)
  - [SQLAlchemy](https://www.sqlalchemy.org/)
- SQLite для базы данных (используется по умолчанию)

## Установка и запуск

1. **Клонируйте репозиторий**:
   ```bash
   git clone https://github.com/username/bunker-bot.git
   cd bunker-bot
   ```

2. **Создайте виртуальное окружение (рекомендуется)**:
   ```bash
   python -m venv venv
   source venv/bin/activate  # для Linux/MacOS
   venv\Scripts\activate     # для Windows
   ```

3. **Установите зависимости**:
   ```bash
   pip install -r requirements.txt
   ```

4. **Настройте токен бота**:
   - Создайте бота с помощью [@BotFather](https://t.me/BotFather) в Telegram.
   - Сохраните токен бота и добавьте его в файл `config.py`:
     ```python
     TOKEN = 'ВАШ_TELEGRAM_BOT_TOKEN'
     DEFAULT_MAX_PLAYERS = 6
     DEFAULT_SURVIVORS = 2
     ```

5. **Инициализация базы данных**:
   - Удалите, если есть, существующий файл `bunker_game.db`.
   - Запустите скрипт для создания и заполнения базы данными:
     ```bash
     python populate_db.py
     ```
   После успешного выполнения все необходимые таблицы и тестовые данные будут созданы.

6. **Запуск бота**:
   ```bash
   python main.py
   ```
   Если всё настроено верно, вы увидите сообщение "Бот запущен...".

## Основные команды

- `/start` — регистрация игрока и начало работы с ботом.
- `/help` — список доступных команд и краткая помощь.
- `/create_room` — создание новой комнаты (доступно хосту).
- `/join_room [код]` — присоединиться к существующей комнате.
- `/leave_room` — покинуть текущую комнату.
- `/start_game` — начать игру (только хост).
- `/stop_game` — завершить игру (только хост).
- `/kick [username]` — исключить игрока из комнаты (хост-команда).
- `/vote` — проголосовать за исключение игрока после обсуждения.
- `/show_status` — показать свои характеристики.
- `/timer [минуты]` — запустить таймер обсуждения (хост-команда).
- `/rating` — показать свой рейтинг (количество побед и поражений).
- `/achievements` — показать свои достижения.
- `/msg [сообщение]` — отправить сообщение всем игрокам комнаты.
- `/pm [username] [сообщение]` — отправить приватное сообщение игроку.

## Логирование и отладка

- Все ошибки и ключевые события записываются в файл `bot.log`.
- Анализируйте этот файл, чтобы быстро находить и устранять проблемы.

## Советы по решению проблем

- Убедитесь, что все игроки, которым отправляются сообщения, уже отправили боту команду `/start`, иначе бот не сможет им писать.
- Если возникнут ошибки с подключением или Telegram API, попробуйте повторить попытку позже или проверить подключение к интернету.
- Обновляйте зависимости и следите за актуальностью версий библиотек.

## Лицензия

Проект распространяется по лицензии MIT. Полный текст лицензии см. в файле [LICENSE](LICENSE).

---

Приятной игры и успехов в развитии вашего бота для «Бункера»!
